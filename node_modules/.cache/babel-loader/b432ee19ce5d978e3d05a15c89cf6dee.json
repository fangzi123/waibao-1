{"remainingRequest":"D:\\vant\\vueUI\\test\\app\\node_modules\\thread-loader\\dist\\cjs.js!D:\\vant\\vueUI\\test\\app\\node_modules\\babel-loader\\lib\\index.js!D:\\vant\\vueUI\\test\\app\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vant\\vueUI\\test\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vant\\vueUI\\test\\app\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vant\\vueUI\\test\\app\\src\\views\\Home.vue","mtime":1537493425459},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1536746400741},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1536746400741},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// @ is an alias to /src\nimport { Actionsheet, Loading, Toast, Dialog } from 'vant';\nimport { get, post } from '../../src/util/http.js';\nimport { formatDatePub, nyr } from '../../src/util/util.js';\n\nrequire('../../src/util/cookie.js');\n\nexport default {\n  name: 'home',\n  components: {\n    Loading: Loading,\n    Actionsheet: Actionsheet,\n    Toast: Toast,\n    Dialog: Dialog\n  },\n  filters: {\n    nyr: nyr\n  },\n  methods: {\n    top: function top(opt) {\n      var _this = this;\n\n      console.log(opt);\n      this.loading = true; //       wxUserDeviceId  必传，下面俩参数传其种一个\n      // alarmSwitch （boolean 类型 true|false）\n      // top       1置顶 0取消置顶\n\n      post('/device/setting/software', {\n        wxUserDeviceId: opt.wxUserDeviceId,\n        top: opt.top ? '0' : '1'\n      }).then(function (res) {\n        if (res.code == 10000) {\n          _this.getList();\n        } else {\n          _this.loading = false;\n          Toast('置顶失败，稍后再试！');\n        }\n      }).catch(function (e) {\n        console.log(e, '------------');\n      });\n    },\n    onSelect: function onSelect(item) {\n      this.show = false; // console.log(item)/\n\n      if (item.url == 'first') {\n        if (item.type == 'gotop') {\n          var opt = this.items[this.currentIndex];\n          this.top(opt);\n        } else if (item.type == 'cancelgotop') {\n          var _opt = this.items[this.currentIndex];\n          this.top(_opt);\n        }\n\n        return;\n      } else if (item.url == 'delete') {\n        var _opt2 = this.items[this.currentIndex];\n        this.dealer(_opt2);\n        return;\n      } else if (item.url == '/wsd/') {\n        var items = this.items[this.currentIndex];\n        var _opt3 = {\n          path: item.url + '' + items.device_id\n        };\n        this.selectId = '';\n        this.$router.push(_opt3);\n      } else {\n        var _opt4 = {\n          path: item.url + '' + this.selectId\n        };\n        this.selectId = '';\n        this.$router.push(_opt4);\n      }\n    },\n    dealer: function dealer(opt) {\n      var _this2 = this;\n\n      Dialog.confirm({\n        title: '确定删除',\n        message: '删除后将不在展示该条数据'\n      }).then(function () {\n        _this2.loading = true; // on confirm\n\n        get('/device/deleleDevice', {\n          wxUserDeviceId: opt.wxUserDeviceId\n        }).then(function (res) {\n          if (res.code == 10000) {\n            _this2.loading = false;\n            Toast('老板，再见...');\n\n            _this2.getList();\n          } else {\n            _this2.loading = false;\n            Toast('哈哈，没珊掉我..');\n          }\n        }).catch(function (e) {\n          _this2.loading = false;\n          Toast('哈哈，没珊掉我..');\n          console.log(e);\n        });\n      }).catch(function () {\n        // on cancel\n        Toast('谢手下留情...');\n      });\n    },\n    set: function set(index, top, id, role) {\n      console.log(arguments);\n      var data = [];\n\n      if (role == 1) {\n        // 2管理员\n        data = [{\n          name: '进入设备详情',\n          url: '/xq/'\n        }, {\n          name: '进入温度曲线',\n          url: '/wsd/'\n        }, {\n          name: '数据设置',\n          url: '/warn/'\n        }, {\n          name: '进入成员列表',\n          url: '/itemlist/'\n        }, {\n          name: '删除',\n          url: 'delete'\n        }, {\n          name: '置顶/取消置顶',\n          url: 'first'\n        }];\n      } else {\n        // 2成员\n        data = [{\n          name: '进入设备详情',\n          url: '/xq/'\n        }, {\n          name: '进入温度曲线',\n          url: '/wsd/'\n        }, {\n          name: '数据设置',\n          url: '/warn/'\n        }, {\n          name: '删除',\n          url: 'delete'\n        }, {\n          name: '置顶/取消置顶',\n          url: 'first'\n        }];\n      }\n\n      this.actions = data;\n\n      if (top == 1) {\n        this.actions[this.actions.length - 1].name = '取消置顶';\n        this.actions[this.actions.length - 1].type = 'cancelgotop';\n      } else {\n        this.actions[this.actions.length - 1].name = '置顶';\n        this.actions[this.actions.length - 1].type = 'gotop';\n      }\n\n      this.selectId = id;\n      this.currentIndex = index;\n      this.show = !this.show;\n    },\n    setFrist: function setFrist() {},\n    setDefault: function setDefault() {},\n    toPercent: function toPercent(point) {\n      var str = Number(point * 100).toFixed(1);\n      str += \"%\";\n      return str;\n    },\n    getList: function getList() {\n      var _this3 = this;\n\n      var opendId = Cookies.get('openId');\n      get('/device/list', {\n        openId: opendId\n      }).then(function (res) {\n        if (res.code == 10000) {\n          _this3.loading = false;\n          _this3.items = res.data;\n\n          _this3.items.forEach(function (el, i) {\n            el.probe_type = el.probe_type == 1 ? '内置探头' : '外置探头 '; // el.time=formatDatePub(el.report_parse_acquisition_time)\n\n            if (el.report_parse_voltage > 3.6) {\n              // 高\n              el.powerL = 1;\n            } else if (el.report_parse_voltage < 3.6 && el.report_parse_voltage > 3.5) {\n              // 中\n              el.powerL = 2;\n            } else if (el.report_parse_voltage < 3.5 && el.report_parse_voltage > 3.45) {\n              // 低\n              el.powerL = 3;\n            } else {\n              el.powerL = 4;\n            }\n          });\n\n          _this3.items.sort(function (a, b) {\n            if (b.top != undefined && a.top != undefined) {\n              return b.top - a.top;\n            }\n          });\n        }\n      }).catch(function (e) {\n        console.log(e);\n      });\n    },\n    toSearch: function toSearch() {\n      var opt = {\n        path: '/search'\n      };\n      this.$router.push(opt);\n    }\n  },\n  data: function data() {\n    return {\n      selectId: '',\n      //当前选择的设备id\n      show: false,\n      isFirst: false,\n      items: [],\n      loading: false,\n      actions: []\n    };\n  },\n  mounted: function mounted() {\n    var _this4 = this;\n\n    console.log('------还是会触发我么？？？？？');\n    this.loading = true; //oJ3fKwNf3IkVFiAGKVu2WE-0i918\n    // var key='oJ3fKwNf3IkVFiAGKVu2WE-0i918'\n    // Cookies('openId',key,{ expires: new Date(new Date().getTime() + (2*24*60*60 * 1000))})\n\n    if (Cookies.get('openId')) {\n      // 如果cookie  有openId\n      this.getList();\n    } else {\n      var code = window.location.search.split('&')[0].split('=')[1];\n\n      if (code) {\n        // 用code  换openId\n        get('/wx/getWebTokenByCode', {\n          code: code\n        }).then(function (res) {\n          if (res.code == 10000 && res.data != undefined && res.data.openid != '' && res.data.openid != undefined) {\n            _this4.userInfo = res.data;\n            Cookies('openId', _this4.userInfo.openid, {\n              expires: new Date(new Date().getTime() + 2 * 24 * 60 * 60 * 1000)\n            });\n\n            _this4.getList();\n          } else {\n            // code 失效 或者接口挂了\n            window.location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxf410780b57e7f0ad&redirect_uri=http%3a%2f%2flive-smart.com.cn%2findex.html%23%2f&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect';\n          }\n        }).catch(function (e) {\n          console.log(e);\n        });\n      } else {\n        // 没有code 去这个地址\n        window.location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxf410780b57e7f0ad&redirect_uri=http%3a%2f%2flive-smart.com.cn%2findex.html%23%2f&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect';\n      }\n    }\n  }\n};",{"version":3,"sources":["Home.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"home\">\n    <p class=\"title\">设备列表</p>\n    <div class=\"search_wrapa\" v-on:click=\"toSearch\">\n      <p class=\"\"><span class=\"fontFamily hht-sousuo\"></span> 请输入搜索关键词</p>\n    </div>\n\n    <div class=\"list_wrap\">\n      <ul>\n        <li v-for=\"(item,index) in items\" v-bind:key=\"index\">\n          <p class=\"machine_name p\"><span class=\"fontFamily hht-guanliyuan Administrator\" v-if=\"item.wxUserDeviceRole==1\"> </span>{{item.name}} <span class=\"fontFamily hht-shezhi1 fr\" v-on:click=\"set(index,item.top,item.wxUserDeviceId,item.wxUserDeviceRole)\"></span></p>\n          <p class=\"t\">\n            <span>温湿度计(名称)</span>\n            <span class=\"fontFamily  hht-WIFIxinhao-ji fr\">信号{{item.report_parse_device_signal}}</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji3 fr\" v-if=\"item.powerL=='1'\">高</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji2 fr\"  v-else-if=\"item.powerL=='2'\">中</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji1 fr\" v-else-if=\"item.powerL=='3'\">低</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji fr\" v-else-if=\"item.powerL=='4'\">无</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji fr\" v-else>{{item.power}}</span>\n          </p>\n          <p class=\"p\">\n            <span>数据设置下发状态:</span>\n            <span class=\"fr\" v-if=\"item.cmdExeStatus==0\">待下发</span>\n            <span class=\"fr\" v-if=\"item.cmdExeStatus==1\">待下发</span>\n            <span class=\"fr\" v-if=\"item.cmdExeStatus==4\">待下发</span>\n            <span class=\"fr\" v-if=\"item.cmdExeStatus==3\">下发失败</span>\n            <span class=\"fr\" v-if=\"item.cmdExeStatus==2\">下发成功</span>\n          </p>\n          <p class=\"wendu p\">\n            <span class=\"fontFamily hht-wendu\">温度：</span>\n            <span>{{item.report_parse_temperature }}℃</span>\n            <span class=\"scope fr \">范围：<span class=\"\">{{item.temperature_low}}-{{item.temperature_high}}</span></span>\n          </p>\n          <p class=\"shidu p\">\n            <span class=\"fontFamily hht-shidu\">湿度：</span>\n            <span>{{item.report_parse_humidity}}</span>\n            <span class=\"scope fr\">范围：<span class=\"\">{{item.humidity_low}}-{{item.humidity_high}}</span></span>\n          </p>\n          <p class=\"info p\">\n            <span>{{item.report_parse_acquisition_time | nyr }}</span>\n            <span>ID:{{item.device_id}}</span>\n            <span>{{item.probe_type}}</span>\n          </p>\n          \n        </li>\n      </ul>\n    </div>\n    <div>\n      <van-actionsheet\n        v-model=\"show\"\n        :actions=\"actions\"\n        @select=\"onSelect\"\n      />\n    </div>\n    <div class=\"load\" v-if=\"loading\">\n      <van-loading color=\"#c1c1c1\" size=\"40px\"/>\n    </div>\n    \n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport { Actionsheet ,Loading,Toast ,Dialog } from 'vant'\nimport {get,post} from '../../src/util/http.js'\nimport {formatDatePub,nyr} from '../../src/util/util.js'\nrequire('../../src/util/cookie.js')\n\nexport default {\n  name: 'home',\n  components: {\n    Loading,\n    Actionsheet ,\n    Toast,\n    Dialog\n  },\n  filters:{\n    nyr\n  },\n  methods:{\n    top(opt){\n      console.log(opt)\n      this.loading=true\n      //       wxUserDeviceId  必传，下面俩参数传其种一个\n      // alarmSwitch （boolean 类型 true|false）\n      // top       1置顶 0取消置顶\n      post('/device/setting/software',{\n        wxUserDeviceId:opt.wxUserDeviceId,\n        top:opt.top?'0':'1'\n      }).then((res)=>{\n        if(res.code==10000){\n          this.getList()\n        }else {\n          this.loading=false\n          Toast('置顶失败，稍后再试！')\n        }\n      }).catch(function(e){\n        console.log(e,'------------')\n      })\n    },\n    onSelect(item){\n      this.show = false;\n      // console.log(item)/\n      if(item.url=='first'){\n        if(item.type=='gotop'){\n          let opt=this.items[this.currentIndex]\n          this.top(opt)\n        }else if(item.type=='cancelgotop'){\n          let opt=this.items[this.currentIndex]\n          this.top(opt)\n        }\n        return\n      }else if(item.url=='delete'){\n        let opt=this.items[this.currentIndex]\n        this.dealer(opt)\n        return\n      }else if(item.url=='/wsd/'){\n        let items=this.items[this.currentIndex]\n        let opt={\n          path:item.url+''+items.device_id\n        }\n        this.selectId=''\n        this.$router.push(opt)\n      }else {\n        let opt={\n          path:item.url+''+this.selectId\n        }\n        this.selectId=''\n        this.$router.push(opt)\n      }\n    },\n    dealer(opt){\n      Dialog.confirm({\n        title: '确定删除',\n        message: '删除后将不在展示该条数据'\n      }).then(() => {\n        this.loading=true\n        // on confirm\n        get('/device/deleleDevice',{wxUserDeviceId:opt.wxUserDeviceId}).then((res)=>{\n          if(res.code==10000){\n            this.loading=false\n            Toast('老板，再见...')\n            this.getList()\n          }else {\n            this.loading=false\n            Toast('哈哈，没珊掉我..')\n          }\n        }).catch((e)=>{\n          this.loading=false\n          Toast('哈哈，没珊掉我..')\n          console.log(e)\n        })\n      }).catch(() => {\n        // on cancel\n        Toast('谢手下留情...')\n      });\n    },\n    set(index,top,id,role){\n      console.log(arguments)\n       let data=[]\n      if(role==1){\n        // 2管理员\n        data=[\n          {\n            name:'进入设备详情',\n            url:'/xq/',\n          },\n          {\n            name:'进入温度曲线',\n            url:'/wsd/'\n          },\n          {\n            name:'数据设置',\n            url:'/warn/'\n          },\n          {\n            name:'进入成员列表',\n            url:'/itemlist/'\n          },\n          {\n            name:'删除',\n            url:'delete'\n          },\n          {\n            name:'置顶/取消置顶',\n            url:'first'\n          }\n        ]\n      }else {\n        // 2成员\n        data=[\n          {\n            name:'进入设备详情',\n            url:'/xq/',\n          },\n          {\n            name:'进入温度曲线',\n            url:'/wsd/'\n          },\n          {\n            name:'数据设置',\n            url:'/warn/'\n          },\n          {\n            name:'删除',\n            url:'delete'\n          },\n          {\n            name:'置顶/取消置顶',\n            url:'first'\n          }\n        ]\n      }\n      this.actions=data\n      if(top==1){\n        this.actions[this.actions.length-1].name='取消置顶';\n        this.actions[this.actions.length-1].type='cancelgotop';\n      }else {\n        this.actions[this.actions.length-1].name='置顶'\n        this.actions[this.actions.length-1].type='gotop';\n      }\n      \n      this.selectId=id\n      this.currentIndex=index\n      this.show=!this.show\n    },\n    setFrist(){\n\n    },\n    setDefault(){\n\n    },\n    toPercent(point){\n        let str=Number(point*100).toFixed(1);\n        str+=\"%\";\n        return str;\n    },\n    getList(){\n      let opendId=Cookies.get('openId')\n      get('/device/list',{openId:opendId}).then((res)=>{\n        if(res.code==10000){\n          this.loading=false\n          this.items=res.data\n          this.items.forEach((el,i)=>{\n            el.probe_type=el.probe_type==1?'内置探头':'外置探头 '\n            // el.time=formatDatePub(el.report_parse_acquisition_time)\n            if(el.report_parse_voltage>3.6){\n              // 高\n              el.powerL=1\n            }else if(el.report_parse_voltage<3.6 && el.report_parse_voltage>3.5 ){\n              // 中\n              el.powerL=2\n            }else if(el.report_parse_voltage<3.5 && el.report_parse_voltage>3.45){\n              // 低\n              el.powerL=3\n            }else {\n               el.powerL=4\n            }\n          })\n          this.items.sort((a,b)=>{\n            if(b.top!=undefined && a.top!=undefined){\n              return b.top-a.top\n            }\n          })\n        }\n      }).catch((e)=>{\n        console.log(e)\n      })\n    },\n    toSearch(){\n      let opt={\n        path:'/search'\n      }\n      this.$router.push(opt)\n    }\n  },\n  data(){\n    return {\n      selectId:'',//当前选择的设备id\n      show:false,\n      isFirst:false,\n      items:[],\n      loading:false,\n      actions:[]\n    }\n  },\n  mounted(){\n    console.log('------还是会触发我么？？？？？')\n    this.loading=true\n\n    //oJ3fKwNf3IkVFiAGKVu2WE-0i918\n    // var key='oJ3fKwNf3IkVFiAGKVu2WE-0i918'\n    // Cookies('openId',key,{ expires: new Date(new Date().getTime() + (2*24*60*60 * 1000))})\n    if(Cookies.get('openId')){\n      // 如果cookie  有openId\n      this.getList()\n    }else{\n      let code= window.location.search.split('&')[0].split('=')[1];\n      if(code){\n        // 用code  换openId\n        get('/wx/getWebTokenByCode',{code:code}).then((res)=>{\n          if(res.code==10000 && res.data!=undefined && res.data.openid!='' &&  res.data.openid!=undefined){\n            this.userInfo=res.data\n            Cookies('openId',this.userInfo.openid,{ expires: new Date(new Date().getTime() + (2*24*60*60 * 1000))})\n            this.getList()\n          }else {\n            // code 失效 或者接口挂了\n            window.location.href='https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxf410780b57e7f0ad&redirect_uri=http%3a%2f%2flive-smart.com.cn%2findex.html%23%2f&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect'\n          }\n        }).catch((e)=>{\n          console.log(e)\n        })\n      }else {\n        // 没有code 去这个地址\n        window.location.href='https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxf410780b57e7f0ad&redirect_uri=http%3a%2f%2flive-smart.com.cn%2findex.html%23%2f&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect'\n      }\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nhtml,body {\n  height: 100%;\n}\n\n.c1 {\n  color: #0087ff;\n}\n\n.title {\n  text-align: center;\n  font-size: .4rem;\n  padding: .4rem;\n}\n.home {\n  min-height: 100%;\n}\n#app {\n  margin: 0px;\n}\n\n* {\n  margin: 0px;\n  text-align: left\n}\n\n.list_wrap ul li .t span {\n  font-size: .32rem;\n  margin-right: .3rem;\n}\n\n.list_wrap ul li {\n  border-bottom: 1px solid #c6c6c6;\n  padding: .2rem 0;\n}\n\n.list_wrap ul li .info {\n  display: flex;\n  flex-direction:row;\n  flex-wrap:nowrap;\n  justify-content:space-between;\n\n}\n\n.list_wrap ul{\n  padding: .2rem .4rem .4rem .4rem;\n}\n\n.list_wrap ul p.t {\n  line-height: .933rem;\n  height: .933rem;\n}\n\n.list_wrap ul .p {\n  line-height: .933rem;\n  height: .933rem;\n}\n\n.list_wrap ul li .p span {\n  margin-right: .267rem;\n  font-size: .32rem;\n}\n\n.machine_name {\n  font-size: .453rem;\n}\n\n.list_wrap ul li .machine_name span {\n  font-size: .48rem;\n  width: .8rem;\n  height: .8rem;\n  text-align: center;\n  vertical-align: middle;\n  color: #0087ff;\n}\n\n.list_wrap ul li .machine_name span:active {\n  color: #333;\n}\n.hht-WIFIxinhao-ji:before {\n  margin-right: 5px;\n}\n\n.search_wrapa p{\n  text-align: left;\n  height: .8rem;\n  line-height: .8rem;\n  background: #fff;\n  font-size: .373rem;\n  color: #c6c6c6;\n  padding-left: .3rem;\n}\n\n.search_wrapa {\n  padding: .2rem;\n  background:rgb(242, 242, 242);\n}\n\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n.Administrator {\n  vertical-align: -1px !important;\n}\n\n</style>\n"],"sourceRoot":"src\\views"}]}