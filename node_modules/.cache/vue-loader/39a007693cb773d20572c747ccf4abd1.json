{"remainingRequest":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vant\\vueUI\\waibao\\waibao\\src\\views\\itemlist.vue?vue&type=style&index=0&id=dfb98404&scoped=true&lang=css&","dependencies":[{"path":"D:\\vant\\vueUI\\waibao\\waibao\\src\\views\\itemlist.vue","mtime":1542015291626},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1536746400741},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.item_list {\n  height: 100%;\n  font-size: .4rem;\n}\n\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n.list {\n  padding: .133rem .4rem;\n}\n.list ul {\n  margin-bottom: .4rem;\n}\n\n.item_list .list .item p{\n  height: .933rem;\n  line-height: .933rem;\n  text-align: left;\n  \n}\n\n.item_list .list ul li {\n  border-bottom: 1px solid #c6c6c6;\n  padding: .133rem 0;\n}\n\n.item_list .list ul li .fr {\n  margin-right: .133rem;\n}\n\n.item_list .list ul li .cov {\n  width: .667rem;\n  height:.667rem;\n  border-radius: 50%;\n  margin-top: .133rem;\n}\n\n.item_list .list ul li p .label:first-child {\n  margin-left: .133rem;\n}\n\n.title {\n  text-align: center;\n  font-size: .4rem;\n  padding: .4rem;\n}\n\n.hint {\n  height: 1.067rem;\n  font-size: .427rem;\n  line-height: 1.067rem;\n  background: #f1f1f1;\n  border-radius: 5px;\n  margin-bottom: 5px;\n}\n",{"version":3,"sources":["itemlist.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0QA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"itemlist.vue","sourceRoot":"src\\views","sourcesContent":["<template>\n  <div class=\"item_list\">\n    <p class=\"title\">成员列表</p>\n    <div class=\"list\">\n      <ul>\n        <li class=\"item\" v-for=\"(item,index) in items\" v-bind:key=\"index\">\n          <p class=\"\">\n            <!-- <span class=\"label\">设置</span> -->\n            <img v-bind:src=\"item.member_headimgurl\" alt=\"\" class=\"label cov\" style=\"margin-right:5px;\">\n            <span class=\"label\">{{item.member_nickname}}</span>\n            <span class=\"fontFamily hht-shezhi1 label fr\" v-on:click=\"edit(item)\"></span>\n          </p>\n          <!-- <p class=\"\">\n            <span class=\"label\">头像：</span>\n            <span class=\"label fr cov\" v-bind:style=\"background\"></span>\n            <img v-bind:src=\"item.member_headimgurl\" alt=\"\" class=\"label fr cov\">\n          </p> -->\n          <!-- <p class=\"\">\n            <span class=\"label\">昵称：</span>\n            \n          </p> -->\n          <!-- <p class=\"\">\n            <span class=\"label\">性别：</span>\n            <span class=\"label fr\">{{item.member_sex==1?'男':'女'}}</span>\n          </p> -->\n          <p class=\"\">\n            <span class=\"label\">审核状态：</span>\n            <span class=\"label fr\">{{item.member_checkStatus==1?'审核通过':'待审核'}}</span>\n          </p>\n        </li>\n      </ul>\n      <p class=\"hint\" v-if=\"loadState==2\" >加载中...</p>\n      <p class=\"hint\" v-if=\"loadState==1\" v-on:click=\"loadMore\">点击加载更多</p>\n      <p class=\"hint\" v-if=\"loadState==3\">没有更多</p>\n      <p class=\"hint\" v-if=\"loadState==4\" v-on:click=\"reload\">加载失败，点击重新加载</p>\n    </div>\n\n    <div class=\"load\" v-if=\"loading\">\n      <van-loading color=\"#c1c1c1\" size=\"40px\"/>\n    </div>\n    <div class=\"actionsheet\">\n      <van-actionsheet\n        v-model=\"show\"\n        :actions=\"actions\"\n        @select=\"onSelect\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport {Loading,Actionsheet,Toast} from 'vant';\nimport {get,post} from '../../src/util/http.js'\nrequire('../../src/util/cookie.js')\n\nexport default {\n  name: 'cjset',\n  components: {\n    Loading,\n    Actionsheet,\n    Toast\n  },\n  data(){\n    return {\n      deviceId:'',\n      loading:true,\n      items:[],\n      show:false,\n      actions:[],\n      loadState:0 ,// 1可以加载 2加载中 3没有跟多 4加载失败\n      pageNum:1,\n      pageSize:10,\n      openId:Cookies.get('openId')?Cookies.get('openId'):'',\n      editData:{} ,// 待编辑数据\n    }\n  },\n  methods:{\n    onSelect(item){\n      this.show = false;\n      if(!this.openId){\n        return\n      }\n      if(item.type=='delete'){\n        // 删除\n        this.loading=true\n        this.delete()\n      }else if(item.type=='move'){\n        // 转让\n        this.loading=true\n        this.move()\n\n      }else if(item.type=='allow'){\n        // 批准\n        this.loading=true\n        this.allow()\n\n      }else if(item.type=='reject'){\n        // 驳回\n        this.loading=true\n        this.reject()\n\n      }\n    },\n    reload(){\n      this.getData()\n    },\n\n    delete(){\n      get('/device/memberDelete',{member_wxUserDeviceId :this.editData.member_wxUserDeviceId,openId:this.openId}).then((res)=>{\n        if(res.code==10000){\n         Toast('删除成功')\n          var id=this.editData.member_wxUserDeviceId\n          var _list=this.items\n          for(var i=0;i<_list.length;i++){\n            if(_list[i].member_wxUserDeviceId==id){\n              _list.splice(i,1)\n              break\n            }\n          }\n          this.loading=false\n          this.items=_list\n        }else {\n          Toast('删除失败')\n          this.loading=false\n        }\n      }).catch((e)=>{\n          this.loading=false\n          Toast('删除失败')\n          console.log(e)\n      })\n    },\n    move(item){\n      get('/device/adminTransfer',{deviceId :this.editData.member_deviceId,fromOpenId:this.openId,toOpenId:this.editData.member_openId}).then((res)=>{\n        if(res.code==10000){\n          this.loading=false\n          Toast('转移成功')\n          this.loading=false\n          this.pageNum=1;\n          this.getData()\n          this.items=[]\n        }else {\n          Toast('转移失败')\n          this.loading=false\n        }\n      }).catch((e)=>{\n        Toast('转移失败')\n        this.loading=false\n        console.log(e)\n      })\n    },\n\n    allow(){\n      // http://live-smart.com.cn/device/checkApproved       GET\n      // 入参：\n      // wxUserDeviceId    成员设备绑定ID\n      get('/device/checkApproved',{wxUserDeviceId:this.editData.member_wxUserDeviceId}).then((res)=>{\n        if(res.code==10000){\n          this.loading=false\n          Toast('审核成功')\n          this.loading=false\n          let id=this.editData.member_wxUserDeviceId\n          this.items.forEach((item,index)=>{\n            if(item.member_wxUserDeviceId==id){\n                item.member_checkStatus=1\n            }\n          })\n         \n        }else {\n          Toast('审核失败')\n          this.loading=false\n        }\n      }).catch((e)=>{\n        Toast('审核失败')\n        this.loading=false\n      })\n    },\n    reject(){\n      // http://live-smart.com.cn/device/checkUnapprove    GET\n      // 入参：\n      // wxUserDeviceId    成员设备绑定ID\n      get('/device/checkUnapprove',{wxUserDeviceId:this.editData.member_wxUserDeviceId}).then((res)=>{\n        if(res.code==10000){\n          this.loading=false\n          Toast('驳回成功')\n          this.loading=false\n          this.pageNum=1;\n          this.getData()\n          this.items=[]\n        }else {\n          Toast('驳回失败')\n          this.loading=false\n        }\n      }).catch((e)=>{\n        Toast('驳回失败')\n        this.loading=false\n      })\n    },\n    loadMore(){\n      this.loading=true\n      let pageNum=this.pageNum\n      pageNum++\n      this.pageNum=pageNum;\n      this.loadState=2\n      this.getData()\n    },\n    getData(){\n      get('/device/memberList',{wxUserDeviceId:this.deviceId,pageNum:this.pageNum,pageSize:this.pageSize}).then((res)=>{\n        if(res.code==10000){\n         this.loading=false\n         this.items= this.items.concat(res.data.list)\n         this.loadState= (this.pageNum*this.pageSize)>=res.data.total?3:1\n        }else if(res.code==30000){\n          // 没有权限 回到上一页\n          this.$router.go(-1)\n        }\n      }).catch((e)=>{\n        this.loadState=4\n        this.loading=false\n        console.log(e)\n      })\n    },\n    edit(item){\n      console.log(item)\n      let data=[]\n      if(item.member_checkStatus==1){\n        data=[\n          {\n            name:'删除',\n            type:'delete'\n          },\n          {\n            name:'转让',\n            type:'move'\n          }\n        ]\n      }else if(item.member_checkStatus==0){\n        data=[\n          {\n            name:'删除',\n            type:'delete'\n          },\n          {\n            name:'批准',\n            type:'allow'\n          },\n          {\n            name:'驳回',\n            type:'reject'\n          }\n        ]\n      }\n      this.actions=data\n      console.log(data,'---------------------')\n      this.editData=item\n      this.show=true\n    }\n  },\n  \n  mounted(){\n    this.deviceId=this.$route.params.id\n    this.getData()\n  }\n}\n</script>\n<style scoped>\n.item_list {\n  height: 100%;\n  font-size: .4rem;\n}\n\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n.list {\n  padding: .133rem .4rem;\n}\n.list ul {\n  margin-bottom: .4rem;\n}\n\n.item_list .list .item p{\n  height: .933rem;\n  line-height: .933rem;\n  text-align: left;\n  \n}\n\n.item_list .list ul li {\n  border-bottom: 1px solid #c6c6c6;\n  padding: .133rem 0;\n}\n\n.item_list .list ul li .fr {\n  margin-right: .133rem;\n}\n\n.item_list .list ul li .cov {\n  width: .667rem;\n  height:.667rem;\n  border-radius: 50%;\n  margin-top: .133rem;\n}\n\n.item_list .list ul li p .label:first-child {\n  margin-left: .133rem;\n}\n\n.title {\n  text-align: center;\n  font-size: .4rem;\n  padding: .4rem;\n}\n\n.hint {\n  height: 1.067rem;\n  font-size: .427rem;\n  line-height: 1.067rem;\n  background: #f1f1f1;\n  border-radius: 5px;\n  margin-bottom: 5px;\n}\n</style>"]}]}