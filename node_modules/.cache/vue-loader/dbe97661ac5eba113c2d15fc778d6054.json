{"remainingRequest":"D:\\vant\\vueUI\\test\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vant\\vueUI\\test\\app\\src\\views\\warn.vue?vue&type=style&index=0&id=42ebbf57&scoped=true&lang=css&","dependencies":[{"path":"D:\\vant\\vueUI\\test\\app\\src\\views\\warn.vue","mtime":1536825335003},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1536746400741},{"path":"D:\\vant\\vueUI\\test\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.warn ul li {\n  height: 1.333rem;\n  line-height: 1.333rem;\n  text-align: left;\n  border-bottom: 1px solid #c6c6c6;\n}\n\n.warn ul {\n  padding: .4rem;\n}\n\n.warn .aling {\n  vertical-align: middle;\n}\n\n.warn .mar {\n  margin-top: .187rem;\n  height: 70%;\n}\n\n.title {\n  font-size: .4rem;\n  padding: .4rem;\n  text-align: center;\n}\n\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n",{"version":3,"sources":["warn.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuiBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"warn.vue","sourceRoot":"src\\views","sourcesContent":["<template>\n  <div class=\"warn\">\n    <p class=\"title\">数据设置</p>\n    <ul>\n      <li>\n        <span>报警开关</span>\n        <span class=\"fr mar\"><van-switch :value=\"checked\" size=\"24px\" @input=\"onInput\" /></span>\n      </li>\n      <li>\n        <span>报警间隔 </span>\n        <span class=\"fr\" v-on:click=\"alarmEdit\">{{ info.alarm_interval | formattingType}} <span class=\"fontFamily hht-xiugai-copy aling\"></span></span>\n      </li>\n      <li>\n        <span>采集间隔 </span>\n        <span class=\"fr\" v-on:click=\"cjEdit\">{{ info.sampling_interval | formattingType}} <span class=\"fontFamily hht-xiugai-copy aling\"></span></span>\n      </li>\n      <li>\n        <span>上报间隔 </span>\n        <span class=\"fr\" v-on:click=\"updateEedit\">{{ info.upload_interval | formattingType}} <span class=\"fontFamily hht-xiugai-copy aling\"></span></span>\n      </li>\n      <li class=\"setmod\">\n        <span>正常温度范围</span>\n        <span class=\"fr \" v-on:click=\"modificationWenDu\"><span>{{info.temperature_low}} <span class=\"fontFamily hht-xiugai-copy aling\"></span></span> - <span >{{info.temperature_high}}<span  class=\"fontFamily hht-xiugai-copy aling\"></span> </span>  </span>\n      </li>\n      <li>\n        <span>正常湿度范围</span>\n        <span class=\"fr \" v-on:click=\"modificationSD\"><span>{{info.humidity_low}} <span class=\"fontFamily hht-xiugai-copy aling\"></span></span> - <span >{{info.humidity_high}} <span  class=\"fontFamily hht-xiugai-copy aling\"></span> </span>  </span>\n      </li>\n    </ul>\n    <div>\n      <van-actionsheet\n        v-model=\"show\"\n        :actions=\"mod\"\n        @select=\"onSelect\"\n      />\n    </div>\n\n    <div class=\"load\" v-if=\"loading\">\n      <van-loading color=\"#c1c1c1\" size=\"40px\"/>\n    </div>\n\n    <div class=\"dialog_wd\">\n      <van-dialog\n        v-model=\"wdDialogShow\"\n        show-cancel-button\n        :before-close=\"WDbeforeClose\"\n      >\n        <van-field\n          v-model=\"temperatureLow\"\n          label=\"温度下线\"\n          placeholder=\"请输入两位小数\"\n        />\n        <van-field\n          v-model=\"temperatureHigh\"\n          label=\"温度上线\"\n          placeholder=\"请输入两位小数\"\n        />\n      </van-dialog>\n    </div>\n    <div class=\"dialog_sd\">\n      <van-dialog\n        v-model=\"sdDialogShow\"\n        show-cancel-button\n        :before-close=\"SDbeforeClose\"\n      >\n        <van-field\n          v-model=\"humidityLow\"\n          label=\"湿度下线\"\n          placeholder=\"请输入两位小数\"\n        />\n        <van-field\n          v-model=\"humidityHigh\"\n          label=\"湿度上线\"\n          placeholder=\"请输入两位小数\"\n        />\n      </van-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport {get,post} from '../../src/util/http.js'\nimport { Switch ,Dialog,Actionsheet,Loading,Toast} from 'vant'\n\nexport default {\n  name: 'warn',\n  components: {\n    Switch,\n    Dialog,\n    Loading,\n    Toast,\n    Actionsheet\n  },\n  filters:{\n    formattingType(val){\n      if(typeof val !='number') return val\n      switch(val)\n      {\n        case 3600:\n        return '1小时'\n        break;\n\n        case 1800:\n        return '30分钟'\n        break;\n\n        case 300:\n        return '5分钟'\n        break;\n\n        case 60:\n        return '1分钟'\n        break;\n\n        case 600:\n        return '10分钟'\n        break;\n\n        case 21600:\n        return '6个小时'\n        break;\n\n        case 43200:\n        return '12个小时'\n        break;\n\n        case 86400:\n        return '24个小时'\n        break;\n      }\n    }\n  },\n  methods:{\n    onInput(checked){\n      Dialog.confirm({\n        title: '提醒',\n        message: '是否切换开关？'\n      }).then(() => {\n        this.loading=true\n        this.switchBtn()\n      }).catch((e)=>{\n        console.log(e)\n      });\n    },\n    switchBtn (){\n      post('/device/setting/software',{\n        wxUserDeviceId:this.deviceId,\n        alarmSwitch:!this.checked\n      }).then((res)=>{\n        if(res.code==10000){\n          this.checked = !this.checked;\n          this.loading=false\n        }else {\n          this.loading=false\n          Toast('切换失败，稍后再试！')\n        }\n      }).catch((res)=>{\n        this.loading=false\n        Toast('切换失败，稍后再试！')\n      })\n    },\n    onSelect(item){\n      console.log(item)\n      let _this=this\n      if(item.type=='cj'){\n        console.log('采集')\n        this.loading=true\n        this.samplingInterval=item.val\n        let cb=function(){\n          _this.show=false\n          _this.loading=false\n          _this.info.sampling_interval=item.val\n          _this.samplingInterval=''\n        }\n\n        this.submitParam(cb)\n      }else if(item.type=='bj'){\n        console.log('报警')\n        this.loading=true\n        this.alarmInterval=item.val\n        let cb=function(){\n          _this.show=false\n          _this.loading=false\n          _this.info.alarm_interval=item.val\n          _this.alarmInterval=''\n        }\n        this.submitParam(cb)\n      }else if(item.type=='sb'){\n        console.log('上报')\n        this.loading=true\n        this.uploadInterval=item.val\n        let cb=function(){\n          _this.show=false\n          _this.loading=false\n          _this.info.upload_interval=item.val\n          _this.uploadInterval=''\n        }\n        this.submitParam(cb)\n      }\n    },\n    edit(){\n      this.show = true;\n    },\n\n    // 修改温度范围\n    modificationWenDu(){\n      this.wdDialogShow=true\n    },\n\n    // 校验温度 范围是否合法\n    checkoutWD(cb){\n      let callback=cb|| function(){}\n      \n      if(this.temperatureLow==''){\n        Toast('温度下限不能为空')\n        cb(false)\n        return\n      }\n\n      if(this.temperatureHigh==''){\n        Toast('温度上限不能为空')\n        cb(false)\n        return\n      }\n\n      if(!this.isNumber(this.temperatureLow)){\n        Toast('请输入正确的温度下线')\n        cb(false)\n        return\n      }\n\n      if(!this.isNumber(this.temperatureHigh)){\n        Toast('请输入正确的温度上线')\n        cb(false)\n        return\n      }\n\n      // 保留两位小数 不做四舍五入 \n      this.temperatureHigh=this.toFixedTow(this.temperatureHigh)\n      this.temperatureLow=this.toFixedTow(this.temperatureLow)\n\n      // 换成number\n      this.temperatureHigh=parseFloat(this.temperatureHigh)\n      this.temperatureLow=parseFloat(this.temperatureLow)\n\n      if(this.temperatureLow<=-655.36){\n        Toast('下线不能小于-655.36')\n        cb(false)\n        return\n      }\n\n      if(this.temperatureHigh>=655.35){\n        Toast('上线不能大于655.35')\n        cb(false)\n        return\n      }\n\n      if(this.temperatureHigh<this.temperatureLow){\n        console.log(this.temperatureHigh,'------------',this.temperatureLow)\n        Toast('下线不能大于上线')\n        cb(false)\n        return\n      }\n      console.log(this.temperatureHigh,'校验合格',this.temperatureLow)\n      let _this=this\n      let cbb=function(){\n        _this.info.temperature_low=_this.temperatureLow\n        _this.info.temperature_high=_this.temperatureHigh\n        _this.temperatureLow=''\n        _this.temperatureHigh=''\n      }\n      this.submitParam(cb,cbb)\n    },\n\n    toFixedTow(val){\n      let reg = /([0-9]+.[0-9]{2})[0-9]*/;\n      val=(val+'').replace(reg,\"$1\")\n      return val\n    },\n\n    // 校验湿度 范围是否合法\n    checkoutSD(cb){\n      let callback=cb|| function(){}\n      // humidityHigh:'',//  湿度上限 \n      // humidityLow :'',//  湿度下限 \n      if(this.humidityLow==''){\n        Toast('湿度下限不能为空')\n        cb(false)\n        return\n      }\n\n      if(this.humidityHigh==''){\n        Toast('湿度上限不能为空')\n        cb(false)\n        return\n      }\n\n      if(!this.isNumber(this.humidityLow)){\n        Toast('请输入正确的湿度下线')\n        cb(false)\n        return\n      }\n\n      if(!this.isNumber(this.humidityHigh)){\n        Toast('请输入正确的湿度上线')\n        cb(false)\n        return\n      }\n\n      // 保留两位小数 不做四舍五入 \n      this.humidityLow=this.toFixedTow(this.humidityLow)\n      this.humidityHigh=this.toFixedTow(this.humidityHigh)\n\n      // 换成number\n      this.humidityLow=parseFloat(this.humidityLow)\n      this.humidityHigh=parseFloat(this.humidityHigh)\n\n      if(this.humidityLow<=0){\n        Toast('下线不能小于0')\n        cb(false)\n        return\n      }\n\n      if(this.humidityHigh>=100){\n        Toast('上线不能大于100')\n        cb(false)\n        return\n      }\n\n      if(this.humidityHigh<this.humidityLow){\n        console.log(this.humidityHigh,'------范围------',this.humidityLow)\n        Toast('下线不能大于上线')\n        cb(false)\n        return\n      }\n      console.log(this.humidityHigh,'校验合格',this.humidityLow)\n      var _this=this\n      let cbb=function(){\n        _this.info.humidity_low=_this.humidityLow\n        _this.info.humidity_high=_this.humidityHigh\n        _this.humidityLow=''\n        _this.humidityHigh=''\n      }\n      this.submitParam(cb,cbb)\n\n    },\n\n    WDbeforeClose(action,done){\n      if(action=='confirm'){\n        this.checkoutWD(done)\n        // setTimeout(done, 1000);\n      }else{\n        done()\n      }\n    },\n    SDbeforeClose(action,done){\n      if(action=='confirm'){\n        // setTimeout(done, 1000);\n        this.checkoutSD(done)\n      }else{\n        done()\n      }\n    },\n\n    unInfo(opt){\n      let obj=opt || {}\n      // if(obj.samplingInterval){\n      //   this.info.\n      // }\n    },\n\n    submitParam(cb,cbb){\n      let callback=cb || function(){}\n      let callbackb=cbb || function(){}\n      let param={\n          deviceId :this.info.device_id,\n          openId:Cookies.get('openId'),\n          samplingInterval:this.samplingInterval,\n          uploadInterval:this.uploadInterval,\n          alarmInterval:this.alarmInterval,\n          temperatureHigh:this.temperatureHigh,\n          temperatureLow:this.temperatureLow,\n          humidityHigh:this.humidityHigh,\n          humidityLow :this.humidityLow\n      }\n      console.log(param)\n      post('/device/setting/hardware',param).then((res)=>{\n        if(res.code==10000){\n          callback && callback()\n          callbackb && callbackb()\n          Toast('修改成功！')\n        }else {\n          Toast('修改失败，稍后再试！1')\n        }\n      }).catch((res)=>{\n        console.log(res,'-----------------')\n        this.loading=false\n        Toast('修改失败，稍后再试！2')\n      })\n    },\n    modificationSD(){\n      this.sdDialogShow=true\n    },\n\n    isNumber(val){\n      let regPos = /^\\d+(\\.\\d+)?$/; //非负浮点数\n      let regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //负浮点数\n      if(regPos.test(val) || regNeg.test(val)){\n          return true;\n      }else{\n          return false;\n      }\n    },\n    getData(){\n      get('/device/view',{wxUserDeviceId:this.deviceId}).then((res)=>{\n        if(res.code==10000){\n          this.info=res.data\n          this.checked=res.data.alarm_switch\n          this.loading=false\n        }\n      }).catch((e)=>{\n        console.log(e)\n      })\n    },\n\n    // 报警编辑\n    alarmEdit(){\n      // 30 1 6 12 24\n      let data=[\n        {\n          name:'30分钟',\n          val:1800,\n          type:'bj'\n        },\n        {\n          name:'1小时',\n          val:3600,\n          type:'bj'\n        },\n        {\n          name:'6小时',\n          val:21600,\n          type:'bj'\n        },\n        {\n          name:'12小时',\n          val:43200,\n          type:'bj'\n        },\n          {\n          name:'24小时',\n          val:86400,\n          type:'bj'\n        },\n      ]\n      this.mod=data\n      this.show = true;\n    },\n\n    // 上报间隔\n    updateEedit(){\n      //  10 30 1 12\n      let data=[\n        {\n          name:'10分钟',\n          val:600,\n          type:'sb'\n        },\n        {\n          name:'30分钟',\n          val:1800,\n          type:'sb'\n        },\n        {\n          name:'1小时',\n          val:3600,\n          type:'sb'\n        },\n        {\n          name:'12小时',\n          val:43200,\n          type:'sb'\n        }\n      ]\n      this.mod=data\n      this.show = true;\n    },\n\n    // 采集编辑\n    cjEdit(){\n      let data=[\n        {\n          name:'1分钟',\n          val:60,\n          type:'cj'\n        },\n        {\n          name:'5分钟',\n          val:300,\n          type:'cj'\n        },\n        {\n          name:'10分钟',\n          val:600,\n          type:'cj'\n        },\n        {\n          name:'1小时',\n          val:3600,\n          type:'cj'\n        }\n      ]\n      this.mod=data\n      this.show = true;\n    }\n  },\n  data(){\n    return {\n      checked:false, // 报警开关  \n      show:false, // 底部弹框 显示 隐藏\n      deviceId:'',\n      info:{}, // 设备信息\n      loading:false, \n\n      samplingInterval:'', //采集间隔\n      uploadInterval:'',//上报间隔\n      alarmInterval:'',//报警间隔 \n\n      temperatureHigh:'',//  温度上限 \n      temperatureLow:'',//  温度下限\n\n      humidityHigh:'',//  湿度上限 \n      humidityLow :'',//  湿度下限 \n\n      wdDialogShow:false ,// 温度编辑弹窗显示\n      sdDialogShow:false,// 湿度编辑弹窗显示\n      mod:[] ,// 底部弹出框的内容\n    }\n  },\n  mounted(){\n    console.log(this.$route.params,'-----------params')\n    this.deviceId=this.$route.params.id\n    this.getData()\n    this.loading=true\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n.warn ul li {\n  height: 1.333rem;\n  line-height: 1.333rem;\n  text-align: left;\n  border-bottom: 1px solid #c6c6c6;\n}\n\n.warn ul {\n  padding: .4rem;\n}\n\n.warn .aling {\n  vertical-align: middle;\n}\n\n.warn .mar {\n  margin-top: .187rem;\n  height: 70%;\n}\n\n.title {\n  font-size: .4rem;\n  padding: .4rem;\n  text-align: center;\n}\n\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n</style>"]}]}