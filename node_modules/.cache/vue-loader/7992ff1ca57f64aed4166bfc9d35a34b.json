{"remainingRequest":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vant\\vueUI\\waibao\\waibao\\src\\views\\Home.vue?vue&type=style&index=0&id=38af2344&scoped=true&lang=css&","dependencies":[{"path":"D:\\vant\\vueUI\\waibao\\waibao\\src\\views\\Home.vue","mtime":1542010872015},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1536746400741},{"path":"D:\\vant\\vueUI\\waibao\\waibao\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhtml,body {\n  height: 100%;\n}\n\n.c1 {\n  color: #0087ff;\n}\n\n.title {\n  text-align: center;\n  font-size: .4rem;\n  padding: .4rem;\n}\n.home {\n  min-height: 100%;\n}\n#app {\n  margin: 0px;\n}\n\n* {\n  margin: 0px;\n  text-align: left\n}\n\n.search_wrapa p{\n  text-align: left;\n  height: .8rem;\n  line-height: .8rem;\n  background: #fff;\n  font-size: .373rem;\n  color: #c6c6c6;\n  padding-left: .3rem;\n}\n\n.search_wrapa {\n  padding: .2rem;\n  background:rgb(242, 242, 242);\n}\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n\n",{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkOA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src\\views","sourcesContent":["<template>\n  <div class=\"home\">\n    <!-- <p class=\"title\">设备列表</p> -->\n    <!-- <p v-db=\"'我是自定义指令'\"></p> -->\n    <div class=\"search_wrapa\" v-on:click=\"toSearch\">\n      <p class=\"\"><span class=\"fontFamily hht-sousuo\"></span> 请输入搜索关键词</p>\n    </div>\n    <div class=\"list_wrap\">\n      <item-list  v-on:select=\"onSelects\" v-bind:list=\"items\"></item-list>\n    </div>\n\n    <!-- <div class=\"list_wrap\">\n      <ul>\n        <li v-for=\"(item,index) in items\" v-bind:key=\"index\">\n          <p class=\"t machine_name\">\n            <span class=\"fontFamily hht-guanliyuan Administrator\" v-if=\"item.wxUserDeviceRole==1\"> </span>{{item.name}}\n            <span class=\"fontFamily hht-shezhi1 fr\" v-on:click=\"set(index,item.top,item.wxUserDeviceId,item.wxUserDeviceRole)\"></span>\n            <span class=\"fontFamily  hht-WIFIxinhao-ji fr\">信号{{item.report_parse_device_signal}}</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji3 fr\" v-if=\"item.powerL=='1'\">高</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji2 fr\"  v-else-if=\"item.powerL=='2'\">中</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji1 fr\" v-else-if=\"item.powerL=='3'\">低</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji fr\" v-else-if=\"item.powerL=='4'\">无</span>\n            <span class=\"fontFamily  hht-dianchidianya_ji fr\" v-else>{{item.power}}</span>\n            <span class=\"fr  fontFamily hht-dengdai\" v-if=\"item.cmdExeStatus==0\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n            <span class=\"fr fontFamily hht-dengdai\" v-if=\"item.cmdExeStatus==1\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n            <span class=\"fr fontFamily hht-dengdai\" v-if=\"item.cmdExeStatus==4\" style=\"font-size:.4rem  margin-right: .2rem;;\"></span>\n            <span class=\"fr fontFamily hht-shibai\" v-if=\"item.cmdExeStatus==3\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n            <span class=\"fr fontFamily hht-chenggong-01\" v-if=\"item.cmdExeStatus==2\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n          </p>\n          <p class=\"p\">\n            <span>数据设置下发状态:</span>\n            <span class=\"fr  fontFamily hht-dengdai\" v-if=\"item.cmdExeStatus==0\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n            <span class=\"fr fontFamily hht-dengdai\" v-if=\"item.cmdExeStatus==1\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n            <span class=\"fr fontFamily hht-dengdai\" v-if=\"item.cmdExeStatus==4\" style=\"font-size:.4rem  margin-right: .2rem;;\"></span>\n            <span class=\"fr fontFamily hht-shibai\" v-if=\"item.cmdExeStatus==3\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n            <span class=\"fr fontFamily hht-chenggong-01\" v-if=\"item.cmdExeStatus==2\" style=\"font-size:.4rem; margin-right: .2rem;\"></span>\n          </p>\n          <p class=\"wendu p\">\n            <span class=\"fontFamily hht-wendu\">温度：</span>\n            <span v-bind:class='returnClass(item.report_parse_temperature,item.temperature_low,item.temperature_high)'>{{item.report_parse_temperature }}℃</span>\n            <span class=\"scope fr \" v-if=\"item.isSeted==1\">范围：<span class=\"\">{{item.temperature_low}}-{{item.temperature_high}}</span></span>\n          </p>\n          <p class=\"shidu p \">\n            <span class=\"fontFamily hht-shidu\">湿度：</span>\n            <span v-bind:class='returnClass(item.report_parse_humidity,item.humidity_low,item.humidity_high)'>{{item.report_parse_humidity}} %RH</span>\n            <span class=\"scope fr\" v-if=\"item.isSeted==1\">范围：<span class=\"\">{{item.humidity_low}}-{{item.humidity_high}}</span></span>\n          </p>\n          <p class=\"info p\">\n            <span>{{item.report_parse_acquisition_time | nyr }}</span>\n            <span>ID:{{item.device_id}}</span>\n            <span>{{item.probe_type}}</span>\n          </p>\n        </li>\n      </ul>\n    </div> -->\n    <div>\n      <van-actionsheet\n        v-model=\"show\"\n        :actions=\"actions\"\n        @select=\"onSelect\"\n      />\n    </div>\n    <div class=\"load\" v-if=\"loading\">\n      <van-loading color=\"#c1c1c1\" size=\"40px\"/>\n    </div>\n    \n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport { Actionsheet ,Loading,Toast ,Dialog } from 'vant'\nimport ItemList  from '../components/citemlist'\nimport {get,post} from '../../src/util/http.js'\nimport {formatDatePub,nyr} from '../../src/util/util.js'\nrequire('../../src/util/cookie.js')\n\nexport default {\n  name: 'home',\n  components: {\n    Loading,\n    Actionsheet ,\n    Toast,\n    Dialog,\n    ItemList\n  },\n  filters:{\n    nyr\n  },\n  methods:{\n    onSelects(){\n      this.getList()\n    },\n    onSelect(item){\n      this.show = false;\n      // console.log(item)/\n      if(item.url=='first'){\n        if(item.type=='gotop'){\n          let opt=this.items[this.currentIndex]\n          this.top(opt)\n        }else if(item.type=='cancelgotop'){\n          let opt=this.items[this.currentIndex]\n          this.top(opt)\n        }\n        return\n      }else if(item.url=='delete'){\n        let opt=this.items[this.currentIndex]\n        this.dealer(opt)\n        return\n      }else if(item.url=='/wsd/'){\n        let items=this.items[this.currentIndex]\n        let opt={\n          path:item.url+''+items.device_id\n        }\n        this.selectId=''\n        this.$router.push(opt)\n      }else {\n        let opt={\n          path:item.url+''+this.selectId\n        }\n        this.selectId=''\n        this.$router.push(opt)\n      }\n    },\n\n    toPercent(point){\n      let str=Number(point*100).toFixed(1);\n      str+=\"%\";\n      return str;\n    },\n    getList(){\n      let opendId=Cookies.get('openId')\n      get('/device/list',{openId:opendId}).then((res)=>{\n        if(res.code==10000){\n          this.loading=false\n          this.items=res.data\n          this.items.forEach((el,i)=>{\n            el.probe_type=el.probe_type==1?'内置探头':'外置探头 '\n            // el.time=formatDatePub(el.report_parse_acquisition_time)\n            if(el.report_parse_voltage>3.6){\n              // 高\n              el.powerL=1\n            }else if(el.report_parse_voltage<3.6 && el.report_parse_voltage>3.5 ){\n              // 中\n              el.powerL=2\n            }else if(el.report_parse_voltage<3.5 && el.report_parse_voltage>3.45){\n              // 低\n              el.powerL=3\n            }else {\n               el.powerL=4\n            }\n          })\n          this.items.sort((a,b)=>{\n            if(b.top!=undefined && a.top!=undefined){\n              return b.top-a.top\n            }\n          })\n        }\n      }).catch((e)=>{\n        console.log(e)\n      })\n    },\n    toSearch(){\n      let opt={\n        path:'/search',\n        query: {\n            id: ''\n        }\n      }\n      this.$router.push(opt)\n    }\n  },\n  directives:{\n    db:{\n      inserted: function (el,value) {\n        el.innerText=value.value\n      }\n    }\n  },\n  data(){\n    return {\n      selectId:'',//当前选择的设备id\n      show:false,\n      isFirst:false,\n      items:[],\n      loading:false,\n      actions:[]\n    }\n  },\n  mounted(){\n    console.log('------还是会触发我么？？？？？')\n    this.loading=true\n\n    //oJ3fKwNf3IkVFiAGKVu2WE-0i918\n    // var key='oJ3fKwNf3IkVFiAGKVu2WE-0i918'\n    // Cookies('openId',key,{ expires: new Date(new Date().getTime() + (2*24*60*60 * 1000))})\n    if(Cookies.get('openId')){\n      // 如果cookie  有openId\n      this.getList()\n    }else{\n      let code= window.location.search.split('&')[0].split('=')[1];\n      if(code){\n        // 用code  换openId\n        get('/wx/getWebTokenByCode',{code:code}).then((res)=>{\n          if(res.code==10000 && res.data!=undefined && res.data.openid!='' &&  res.data.openid!=undefined){\n            this.userInfo=res.data\n            Cookies('openId',this.userInfo.openid,{ expires: new Date(new Date().getTime() + (2*24*60*60 * 1000))})\n            this.getList()\n          }else {\n            // code 失效 或者接口挂了\n            window.location.href='https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxf410780b57e7f0ad&redirect_uri=http%3a%2f%2flive-smart.com.cn%2findex.html%23%2f&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect'\n          }\n        }).catch((e)=>{\n          console.log(e)\n        })\n      }else {\n        // 没有code 去这个地址\n        window.location.href='https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxf410780b57e7f0ad&redirect_uri=http%3a%2f%2flive-smart.com.cn%2findex.html%23%2f&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect'\n      }\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nhtml,body {\n  height: 100%;\n}\n\n.c1 {\n  color: #0087ff;\n}\n\n.title {\n  text-align: center;\n  font-size: .4rem;\n  padding: .4rem;\n}\n.home {\n  min-height: 100%;\n}\n#app {\n  margin: 0px;\n}\n\n* {\n  margin: 0px;\n  text-align: left\n}\n\n.search_wrapa p{\n  text-align: left;\n  height: .8rem;\n  line-height: .8rem;\n  background: #fff;\n  font-size: .373rem;\n  color: #c6c6c6;\n  padding-left: .3rem;\n}\n\n.search_wrapa {\n  padding: .2rem;\n  background:rgb(242, 242, 242);\n}\n.load {\n  position: fixed;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n  background: #333;\n  opacity: .8;\n  border-radius:.133rem;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.load .van-loading {\n  vertical-align: middle;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n\n\n</style>\n"]}]}